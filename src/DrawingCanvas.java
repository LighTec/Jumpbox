import javafx.event.EventHandler;
import javafx.scene.canvas.Canvas;
import javafx.scene.canvas.GraphicsContext;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.AnchorPane;
import javafx.scene.paint.Color;

import java.util.ArrayList;
import java.util.concurrent.TimeUnit;


public class DrawingCanvas
{

    private static int test = 0;
    private Canvas canvas;
    private GraphicsContext gc;
    private ArrayList<String> cords;

    DrawingCanvas(AnchorPane canvasParent) throws InterruptedException {
        cords = new ArrayList<String>();

        // Create the Canvas
        canvas = new Canvas(590, 526);

        // Get the graphics context of the canvas
        gc = canvas.getGraphicsContext2D();
        gc.setLineWidth(5);
        gc.setStroke(Color.ORANGERED);

        canvasParent.setStyle("-fx-border-style: solid inside;" +
                "-fx-border-width: 2;" +
                "-fx-border-insets: 1;" +
                "-fx-border-radius: 5;" +
                "-fx-border-color: black;");

        canvas.addEventHandler(MouseEvent.MOUSE_PRESSED, mouseDown);
        canvas.addEventHandler(MouseEvent.MOUSE_DRAGGED, mouseMove);

        canvas.addEventHandler(MouseEvent.MOUSE_RELEASED,mouseUp);



        canvasParent.getChildren().add(canvas);


    }

    public void draw(String coords){
        String[] coordList = coords.split(",");
        gc.beginPath();
        gc.moveTo(Double.parseDouble(coordList[0]), Double.parseDouble(coordList[1]));
        gc.lineTo(Double.parseDouble(coordList[2]), Double.parseDouble(coordList[3]));
        gc.stroke();
        gc.closePath();
    }

    public void resetCanvas() {

        draw("268.8,317.59999999999997,267.2,317.59999999999997");
        draw("267.2,317.59999999999997,264.0,316.0");
        draw("264.0,316.0,262.4,315.2");
        draw("262.4,315.2,260.0,313.59999999999997");
        draw("260.0,313.59999999999997,257.6,311.2");
        draw("257.6,311.2,255.2,308.8");
        draw("255.2,308.8,251.2,305.59999999999997");
        draw("251.2,305.59999999999997,247.2,301.59999999999997");
        draw("247.2,301.59999999999997,241.60000000000002,296.0");
        draw("241.60000000000002,296.0,239.2,291.2");
        draw("239.2,291.2,232.0,284.0");
        draw("232.0,284.0,226.39999999999998,277.59999999999997");
        draw("226.39999999999998,277.59999999999997,224.0,273.59999999999997");
        draw("224.0,273.59999999999997,218.39999999999998,266.4");
        draw("218.39999999999998,266.4,210.39999999999998,253.59999999999997");
        draw("210.39999999999998,253.59999999999997,208.8,248.8");
        draw("208.8,248.8,201.60000000000002,232.0");
        draw("201.60000000000002,232.0,200.8,228.8");
        draw("200.8,228.8,200.0,225.59999999999997");
        draw("200.0,225.59999999999997,197.60000000000002,222.39999999999998");
        draw("197.60000000000002,222.39999999999998,196.8,220.8");
        draw("196.8,220.8,196.8,219.2");
        draw("196.8,219.2,196.8,217.59999999999997");
        draw("196.8,217.59999999999997,196.0,216.0");
        draw("196.0,216.0,195.2,214.39999999999998");
        draw("195.2,214.39999999999998,195.2,213.6");
        draw("195.2,213.6,194.39999999999998,212.0");
        draw("194.39999999999998,212.0,194.39999999999998,211.2");
        draw("194.39999999999998,211.2,194.39999999999998,208.79999999999998");
        draw("194.39999999999998,208.79999999999998,194.39999999999998,207.2");
        draw("194.39999999999998,207.2,194.39999999999998,202.39999999999998");
        draw("194.39999999999998,202.39999999999998,195.2,199.2");
        draw("195.2,199.2,196.0,196.0");
        draw("196.0,196.0,196.8,193.6");
        draw("196.8,193.6,198.39999999999998,188.79999999999998");
        draw("198.39999999999998,188.79999999999998,199.2,185.6");
        draw("199.2,185.6,200.0,183.2");
        draw("200.0,183.2,201.60000000000002,180.79999999999998");
        draw("201.60000000000002,180.79999999999998,204.8,177.6");
        draw("204.8,177.6,207.2,175.2");
        draw("207.2,175.2,209.60000000000002,171.2");
        draw("209.60000000000002,171.2,212.0,168.79999999999998");
        draw("212.0,168.79999999999998,224.0,161.6");
        draw("224.0,161.6,229.60000000000002,160.0");
        draw("229.60000000000002,160.0,230.39999999999998,160.0");
        draw("230.39999999999998,160.0,232.8,160.0");
        draw("232.8,160.0,234.39999999999998,160.0");
        draw("234.39999999999998,160.0,235.2,160.0");
        draw("235.2,160.0,237.60000000000002,160.0");
        draw("237.60000000000002,160.0,238.39999999999998,160.0");
        draw("238.39999999999998,160.0,239.2,160.79999999999998");
        draw("239.2,160.79999999999998,242.39999999999998,163.2");
        draw("242.39999999999998,163.2,246.39999999999998,166.39999999999998");
        draw("246.39999999999998,166.39999999999998,249.60000000000002,171.2");
        draw("249.60000000000002,171.2,256.8,182.39999999999998");
        draw("256.8,182.39999999999998,258.4,184.79999999999998");
        draw("258.4,184.79999999999998,259.2,188.0");
        draw("259.2,188.0,259.2,188.79999999999998");
        draw("259.2,188.79999999999998,259.2,189.6");
        draw("259.2,189.6,260.0,190.39999999999998");
        draw("260.0,190.39999999999998,260.0,191.2");
        draw("260.0,191.2,260.8,192.0");
        draw("260.8,192.0,261.6,192.79999999999998");
        draw("261.6,192.79999999999998,262.4,192.79999999999998");
        draw("262.4,192.79999999999998,263.2,192.79999999999998");
        draw("263.2,192.79999999999998,263.2,191.2");
        draw("263.2,191.2,264.8,188.79999999999998");
        draw("264.8,188.79999999999998,265.6,188.0");
        draw("265.6,188.0,279.2,171.2");
        draw("279.2,171.2,281.6,169.6");
        draw("281.6,169.6,284.0,168.0");
        draw("284.0,168.0,288.8,164.79999999999998");
        draw("288.8,164.79999999999998,296.0,161.6");
        draw("296.0,161.6,300.0,160.0");
        draw("300.0,160.0,305.6,158.39999999999998");
        draw("305.6,158.39999999999998,308.0,158.39999999999998");
        draw("308.0,158.39999999999998,311.2,158.39999999999998");
        draw("311.2,158.39999999999998,312.8,158.39999999999998");
        draw("312.8,158.39999999999998,315.2,158.39999999999998");
        draw("315.2,158.39999999999998,317.6,158.39999999999998");
        draw("317.6,158.39999999999998,320.0,159.2");
        draw("320.0,159.2,324.8,161.6");
        draw("324.8,161.6,330.4,164.79999999999998");
        draw("330.4,164.79999999999998,332.0,166.39999999999998");
        draw("332.0,166.39999999999998,333.6,168.0");
        draw("333.6,168.0,336.8,170.39999999999998");
        draw("336.8,170.39999999999998,340.0,174.39999999999998");
        draw("340.0,174.39999999999998,343.2,180.0");
        draw("343.2,180.0,346.4,185.6");
        draw("346.4,185.6,346.4,188.79999999999998");
        draw("346.4,188.79999999999998,347.20000000000005,191.2");
        draw("347.20000000000005,191.2,348.0,193.6");
        draw("348.0,193.6,348.0,196.0");
        draw("348.0,196.0,348.0,198.39999999999998");
        draw("348.0,198.39999999999998,348.0,201.6");
        draw("348.0,201.6,348.0,204.79999999999998");
        draw("348.0,204.79999999999998,348.0,208.0");
        draw("348.0,208.0,347.20000000000005,212.0");
        draw("347.20000000000005,212.0,345.6,217.59999999999997");
        draw("345.6,217.59999999999997,341.6,225.59999999999997");
        draw("341.6,225.59999999999997,339.2,232.0");
        draw("339.2,232.0,334.4,240.8");
        draw("334.4,240.8,328.8,250.39999999999998");
        draw("328.8,250.39999999999998,324.0,256.8");
        draw("324.0,256.8,321.6,260.8");
        draw("321.6,260.8,316.8,265.59999999999997");
        draw("316.8,265.59999999999997,314.4,268.0");
        draw("314.4,268.0,312.0,272.0");
        draw("312.0,272.0,310.4,274.4");
        draw("310.4,274.4,307.2,278.4");
        draw("307.2,278.4,304.0,280.8");
        draw("304.0,280.8,298.4,287.2");
        draw("298.4,287.2,295.2,291.2");
        draw("295.2,291.2,292.8,295.2");
        draw("292.8,295.2,288.8,300.0");
        draw("288.8,300.0,287.2,301.59999999999997");
        draw("287.2,301.59999999999997,285.6,304.0");
        draw("285.6,304.0,284.0,305.59999999999997");
        draw("284.0,305.59999999999997,283.2,306.4");
        draw("283.2,306.4,282.4,307.2");
        draw("282.4,307.2,281.6,307.2");
        draw("281.6,307.2,281.6,308.0");
        draw("281.6,308.0,280.8,308.8");
        draw("280.8,308.8,280.0,309.59999999999997");
        draw("280.0,309.59999999999997,280.0,310.4");
        draw("280.0,310.4,279.2,310.4");
        draw("279.2,310.4,278.4,311.2");
        draw("278.4,311.2,277.6,312.8");
        draw("277.6,312.8,276.8,312.8");
        draw("276.8,312.8,276.8,313.59999999999997");
        draw("276.8,313.59999999999997,276.0,314.4");
        draw("276.0,314.4,275.2,315.2");
        draw("275.2,315.2,274.4,315.2");
        draw("274.4,315.2,273.6,315.2");
        draw("273.6,315.2,273.6,316.0");
        draw("273.6,316.0,273.6,316.0");
    }

    private EventHandler<MouseEvent> mouseDown =  new EventHandler<MouseEvent>() {
        @Override
        public void handle(MouseEvent event) {
            resetCanvas();
            gc.beginPath();
            gc.moveTo(event.getX(), event.getY());
            cords.add(event.getX() + "," + event.getY());
        }
    };

    private EventHandler<MouseEvent> mouseMove =  new EventHandler<MouseEvent>() {
        @Override
        public void handle(MouseEvent event) {
            gc.lineTo(event.getX(), event.getY());
            gc.stroke();
            gc.closePath();
            cords.add(event.getX() + "," + event.getY());
            System.out.println(cords.get(0) + "," + cords.get(1));
            cords.clear();
            test++;
            gc.beginPath();
            gc.moveTo(event.getX(), event.getY());
            cords.add(event.getX() + "," + event.getY());
        }
    };

    private EventHandler<MouseEvent> mouseUp =  new EventHandler<MouseEvent>() {
        @Override
        public void handle(MouseEvent event) {
            gc.lineTo(event.getX(), event.getY());
            gc.stroke();
            gc.closePath();
            cords.add(event.getX() + "," + event.getY());
            cords.clear();
            test++;
            System.out.println("total packets:" + test);
        }
    };
}